from calibre.web.feeds.news import BasicNewsRecipe
from calibre.ebooks.BeautifulSoup import NavigableString

class reduxOfficial(BasicNewsRecipe):
    title = 'ECMAScript 6 入门'
    __author__ = '阮一峰'
    description = ('一峰新作'
                   '疯狂es6入门佳作')
    timefmt = '[%Y-%m-%d]'
    no_stylesheets = True
    cover_url = 'http://es6.ruanyifeng.com/images/cover-2nd.jpg'
    url_prefix = 'http://es6.ruanyifeng.com/'
    keep_only_tags = [{'id': 'content'},
                      ]
    remove_tags = [{'id': 'disqus_thread'},]

    def parse_index(self):
        soup = self.index_to_soup(self.url_prefix + '#docs/intro')
        print soup
        articles = []
        titles = soup.find('div',{'id': 'sidebar'}).ol
        print titles
        for item in titles.contents: 
            title = item.a.string 
            url = self.url_prefix  + item.a.href
            article = {'title': title, 'url': url}
            print url,article
            articles.push( article )

        # print 'articles', articles
        ans = [('ECMAScript 6 入门', articles)]
        return ans
